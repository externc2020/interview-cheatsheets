AMQP 事务 RocketMQ


openmessaging/openmessaging-storage-dledger
A raft-based java library for building high-available, high-durable, strong-consistent commitlog.

分布式事务 xa 2pc 3pc tcc saga mq paxos zab raft

seata 库

微服务 -> 分布式

base

zookeeper

STM

split-brain 脑裂：集群选举出两个 leader，出现不一致
解决方法：
选举法
paxos 只有集群中超过半数节点投票才能选举出Leader。ZooKeeper默认采用了这种方式。但是它的限制也很明显就是如果出现过半的机器宕机，会导致整个集群无法正常提供服务

冗余通信（Redundant communications）
顾名思义，冗余通信的方式来保证通信的高可用性，避免出现分区

隔离（fencing）
引入公共共享资源，第三方存储。例如：数据库（当然还可以选其他存储：redis、zk等）维护leader信息
leader选举成功维护一条数据库数据，表明自身为leader，对该数据的读写以串行的方式保证并发安全性
如果follower与leader失联，尝试选举自身为leader，结果发现数据库中已经有leader存在
通过RPC、ssh等等方式执行已经存在的leader服务器上的方法终止老leader进程，如果成功则更新leader为自身
隔离的方式也采用了冗余通信的方式，如果远程终止leader进程的调用失败，则集群也会持续处于不可用状态


HDFS脑裂问题选用的为：隔离方案
Zookeeper脑裂问题选用的为：选举法（过半概念），ZAB（zookeeper atomic broadcast）



raft (http://thesecretlivesofdata.com/raft/) 类似主从，但是主通过选举产生
node state: follower, candidate, leader









