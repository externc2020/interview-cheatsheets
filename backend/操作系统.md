# 操作系统（Operating System）

本文以 Linux 内核为主

### 内核

- 内核模块
- 内核态，用户态
- 驱动：字符设备，块设备
- 系统调用（system call）中断
- 加载：x86 实模式 -> 虚模式
- 自旋锁，信号量，互斥锁（mutex），读写锁（RCU，Read Copy Update）
- ioctl
- 监控，调试：BPF

### 进程

- fork/vfork/clone
- 内存分布
- IPC：管道，命名管道，信号，消息（dbus），套接字（socket），mmap，shm
- 调度（CFS），上下文
- 静态链接，动态链接

### 线程（内核线程，轻量级线程）

- 上下文

### 内存管理

- 段，页，页表（page table)
- 多级页表：ARM（PGD + PTE）
- 虚拟内存,MMU
- TLB（Translation Lookaside Buffer）快表，作页表缓冲
- vmalloc 用于申请大块内存，虚拟地址连续，物理地址不一定连续，不能直接用于DMA，在进程地址空间有专门的一块。
- kmalloc 用于申请小内存，由 slab 管理实现，一般至少小于4KB（page）。不能申请大于128K的数据。物理地址和虚拟地址都连续，可用于DMA操作。
- slab 分配器

### 文件系统

- Linux 通过 VFS（Virtual File System）支持多种文件系统：inode，dentry，file，super_block
- 文件类型：普通，目录，链接，设备，管道，

### 网络

- select/poll/epoll
- netfilter 框架
