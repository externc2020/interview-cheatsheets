### 常见名词

- 锁，乐观，悲观，偏向，轻量，重量，自旋，无锁
- CAS = Compare And Swap
- JUC = java.util.concurrent
- 可见性，有序性，原子性

### 常见问题

- synchronized与lock的区别，使用场景
- Java锁有哪些种类，以及区别
- 如何保证内存可见性
- volatile关键字的如何保证内存可见性

### 线程安全有三要素

- 可见性
- 有序性
- 原子性

### as-if-serial 原则（JVM 规范）

就是单线程指令重排后最后效果和顺序写效果一致

### happens-before 原则（JVM 规范）

- 程序顺序规则：在一个线程内部，按照程序代码的书写顺序，书写在前面的代码操作Happens-Before书写在后面的代码操作。
- 锁定规则：对锁M解锁之前的所有操作Happens-Before对锁M加锁之后的所有操作。
- volatile变量规则：对一个volatile变量的写操作及这个写操作之前的所有操作Happens-Before对这个变量的读操作及这个读操作之后的所有操作。
- 线程启动规则：Thread对象的start方法及书写在start方法前面的代码操作Happens-Before此线程的每一个动作。
- 线程终止规则：线程中的任何操作都Happens-Before其它线程检测到该线程已经结束。
- 中断规则：一个线程在另一个线程上调用interrupt,Happens-Before被中断线程检测到interrupt被调用。
- 终结器规则：一个对象的构造函数执行结束Happens-Before它的finalize()方法的开始。
- 传递性规则：如果操作A Happens-Before B，B Happens-Before C，那么可以得出操作A Happens-Before C。

### 反应堆模型

NIO 1.4 selectors /reactor pattern
NIO.2 1.7 completion handlers / proactor pattern / aio
从上面可以看出，Reactor和Proactor模式的主要区别就是真正的读取和写入操作是有谁来完成的，Reactor中需要应用程序自己读取或者写入数据，而Proactor模式中，应用程序不需要进行实际的读写过程，它只需要从缓存区读取或者写入即可，操作系统会读取缓存区或者写入缓存区到真正的IO设备.
IO复用下的事件驱动模型
reactor：能收了你跟俺说一声。
proactor: 你给我收十个字节，收好了跟俺说一声。IOCP/Boost.Asio
callback就是reactor
future/await就是proactor
